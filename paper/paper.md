---
title: 'HallThruster.jl: A Julia package for 1D fluid Hall Thruster discharges'
tags:
  - Plasma physics
  - Low temperature magnetized plasma
  - CFD
  - Hall Thruster
  - Electric Propulsion
  - Julia
authors:
  - name: Thomas Marks # note this makes a footnote saying 'Co-first author'
    orcid: 0000-0000-0000-0000
    affiliation: 1 # (Multiple affiliations must be quoted)
  - name: Paul Schedler # note this makes a footnote saying 'Co-first author'
    affiliation: 2
affiliations:
 - name: Plasmadynamics and Electric Propulsion Laboratory, University of Michigan, Ann Arbor, US
   index: 1
 - name: ETH Zurich, Zurich, Switzerland
   index: 2
date: 22 April 2022
bibliography: paper.bib

# Summary

Hall thrusters are annular devices where an electric field is generated by an anode and and hollow cathode, perpendicular to a magnetic field applied by coils on the outer walls and centerline of the thruster. This results in electrons being trapped along the magnetic field lines, creating a strong azimuthal Hall current, ionizing injected gas, usually xenon. The ions are then accelerated out of the channel, which generates thrust. Hall thrusters offer a specific impulse on the order of 1500-3000s, and can achieve efficiencies higher than 50\%. An overview is available in @goebelkatzhall and @physicsmodeling. Hall Thrusters are commonly used for in-space propulsion for commercial communications and surveillance satellites as well as deep space missions. Reduced order modelling is critical to deepen the understanding of these devices.


# Statement of need

`HallThruster.jl` is a 1D fluid Hall Thruster discharge model. Julia enables the efficient
implementation of a flexible code by employing its multi-dispatch architecture. The "anomalous"
electron transport in Hall Thrusters is an unsolved problem and currently prohibits
predictive Hall Thruster simulations. As full time and length resolving particle simulations of 
low temperature magnetized plasmas at the scales required for Hall Thrusters are prohibitively
expensive, another option is to infer anomalous collision frequency models using large datasets. 
This is where HallThruster.jl is applied to in the scientific community. 

`HallThruster.jl` can be used in teaching due to the simple interface and extensive documentation. 
It can provide students with a first order understanding of the governing physics in Hall Thrusters. 
The Landmark study @landmarkplasma provides a benchmark for 1D fluid Hall Thruster discharges, which 
is reinforced by a public repository like `HallThruster.jl` recreating its results. 

# Physics model

add figure of channel with 1d domain

The physics model is based upon the work presented in @haraquasineutralfluid. The species are approximated as fluids, 
with the neutral, ions and electrons treated separately. Quasineutrality $n_e = \sum_j^Z q_j n_{ij}$ is assumed in the entire domain. Neutrals are treated with constant temperature and velocity, only the continuity equation is solved. $n_n$ is the neutral number density and $u_n$ the neutral velocity.

\begin{equation}
    \frac{\partial n_n}{\partial t} + \frac{\partial}{\partial z} (n_n u_n) = \dot{n}_n
\label{eq:neutrals}
\end{equation}

The source term in \autoref{eq:neutrals} is a loss term corresponding to the rate at which neutrals are ionized. Recombination in the domain is neglected in this model. Ions are approximated as isothermal, and the ion continuity and momentum equation are solved. 

\begin{equation}
    \frac{\partial n_{ij}}{\partial t} + \frac{\partial}{\partial z} (n_{ij} u_{ij}) = \dot{n}_{ij}
\label{eq:ioncontinuity}
\end{equation}

\begin{equation}
    \frac{\partial}{\partial t} (n_{ij} u_{ij}) + \frac{\partial}{\partial z} (n_{ij} u_{ij}^2 + \frac{p_{ij}}{m_i}) = \frac{j e}{m_i} n_{ij} E_z
\label{eq:ionmomentum}
\end{equation}

where j corresponds to the ion charge state. Up to three ion fluids with different charge states are supported in `HallThruster.jl`. The source term describes the ion acceleration due to the electric field. The electrons are assumed massless and their inertia is neglected. Additionally, the electric field is assumed purely axial and the magnetic field purely radial, which leads to the generalized Ohm's law. 

\begin{equation}
    j_{ez} = \frac{e^2 n_e}{m_e \nu_e}\frac{1}{1 + \Omega_e^2}\left(E_z + \frac{1}{e n_e}\frac{\partial p_e}{\partial z}\right)
\label{eq:eleccurrentaxial}
\end{equation}

\autoref{eq:eleccurrentaxial} describes the electron current in axial direction, where $\Omega_e = \omega_{ce}/\nu_e = e |B| / m_e \nu_e$ is the Hall parameter. This is a measure of how magnetized the electrons are. The first two terms on the left hand side can be extracted and are collectively known as the cross field electron mobility, since the axial direction is perpendicular to the applied magnetic field. 

\begin{equation}
    \mu_{\perp} = \frac{e n_e}{m_e \nu_e}\frac{1}{1 + \Omega_e^2}
\label{eq:electronmobility}
\end{equation}

The collision frequency $nu_e$ effectively controls the cross field electron mobility $\nu_{perp}$ and consists of the classical and anomalous electron collision frequencies. It it this parameter that `HallThruster.jl` is designed to help finding a closure for.

\begin{equation}
    \frac{\partial}{\partial t}\left(\frac{3}{2} n_e k_B T_e\right) + \frac{\partial}{\partial z}\left(\frac{5}{2} n_e k_B T_e u_{ez} + q_{ez}\right) = e n_e u_{ez} \frac{\partial\phi}{\partial z} - S_{loss}
\label{eq:electronenergy}
\end{equation}

\autoref{eq:electronenergy} is the electron internal energy equation. Different closure models are adopted for the heat flux $q_{ez}$. The first term on the right hand side describes Ohmic heating, while $S_{loss}$ accounts for ionization, excitation and wall losses. Assuming electrostatics and current conservation, \autoref{eq:eleccurrrentaxial} can be used to obtain an elliptic equation for the potential. 

\begin{equation}
    \frac{\partial}{\partial z}\left(\mu_{\perp} n_e \frac{\partial\phi}{\partial z}\right) = \frac{\partial}{\partial z}\left(\frac{\mu_{\perp}}{e}\frac{\partial p_e}{\partial z} - \frac{j_{iz}}{e}\right)
\label{eq:potential}
\end{equation}


# Numerics

The finite volume method is applied to transform the fluid partial differential equations into a system of ordinary differential equations. These are integrated in time using `DifferentialEquations.jl` @rackauckas2017differentialequations. A simple upwind scheme as well as approximate Riemann solvers are available. The elliptic equation for the potential is transformed by finite differences into a linear system $A x = b$, which is solved using the Thomas' algorithm. This is done on a staggered grid to prevent odd-even decoupling. The electron energy equation is solved semi-implicitly to ease timestep restrictions by applying a Crank Nicholson scheme. Reactions and collisions are modelled as a function of the electron energy, and rate coefficients have been generated using BOLSIG+. Order verification studies to verify the correct implementation are aided by `Symbolics.jl` @gowda2021high. 

add figure of example simulation with landmark data. 


# References